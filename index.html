<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Base64 音频播放器</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f7f7f7; margin: 0; padding: 0; }
    .container { max-width: 600px; margin: 40px auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 8px #0001; padding: 32px; }
    h2 { text-align: center; color: #333; }
    textarea { width: 100%; height: 120px; border-radius: 6px; border: 1px solid #ccc; padding: 10px; font-size: 15px; margin-bottom: 16px; }
    .controls { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
    .btn { background: #4f8cff; color: #fff; border: none; border-radius: 6px; padding: 8px 18px; font-size: 15px; cursor: pointer; transition: background 0.2s; }
    .btn:hover { background: #2563eb; }
    .icon { width: 22px; height: 22px; vertical-align: middle; }
    .progress { flex: 1; }
    .audio-bar { width: 100%; }
    .time { font-size: 13px; color: #666; min-width: 60px; text-align: right; }
    .download-link { margin-left: 10px; }
    .footer { text-align: center; color: #aaa; font-size: 13px; margin-top: 24px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Base64 音频播放器</h2>
    <textarea id="b64" placeholder="粘贴你的base64音频内容（只需内容，不要加data:audio/mp3;base64,）"></textarea>
    <div class="controls">
      <button class="btn" onclick="loadAudio()">
        <img class="icon" src="https://img.icons8.com/ios-filled/50/ffffff/play--v1.png"/> 加载音频
      </button>
      <audio id="audio" style="display:none"></audio>
      <button class="btn" id="playPauseBtn" onclick="togglePlay()" disabled>
        <img id="playPauseIcon" class="icon" src="https://img.icons8.com/ios-filled/50/ffffff/play--v1.png"/>
      </button>
      <input type="range" id="progress" class="progress audio-bar" value="0" min="0" max="100" step="1" disabled>
      <span class="time" id="time">00:00 / 00:00</span>
      <a id="download" class="download-link" href="#" download="audio.mp3" style="display:none">
        <img class="icon" src="https://img.icons8.com/ios-filled/50/4f8cff/download--v1.png"/>
      </a>
    </div>
    <div class="footer">
      © 2024 Base64 音频播放器 | <a href="https://github.com/TianLeung/base64-audio-player" target="_blank">GitHub</a>
    </div>
  </div>
  <script>
    const audio = document.getElementById('audio');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const playPauseIcon = document.getElementById('playPauseIcon');
    const progress = document.getElementById('progress');
    const time = document.getElementById('time');
    const download = document.getElementById('download');

    function loadAudio() {
      let b64 = document.getElementById('b64').value.trim();
      if (!b64) {
        alert('请粘贴base64音频内容！');
        return;
      }
      let dataUrl = 'data:audio/mp3;base64,' + b64;
      audio.src = dataUrl;
      audio.load();
      playPauseBtn.disabled = false;
      progress.disabled = false;
      download.href = dataUrl;
      download.style.display = '';
    }

    function togglePlay() {
      if (audio.paused) {
        audio.play();
      } else {
        audio.pause();
      }
    }

    audio.addEventListener('play', () => {
      playPauseIcon.src = "https://img.icons8.com/ios-filled/50/ffffff/pause--v1.png";
    });
    audio.addEventListener('pause', () => {
      playPauseIcon.src = "https://img.icons8.com/ios-filled/50/ffffff/play--v1.png";
    });

    audio.addEventListener('timeupdate', () => {
      if (audio.duration) {
        progress.value = (audio.currentTime / audio.duration * 100).toFixed(0);
        time.textContent = formatTime(audio.currentTime) + ' / ' + formatTime(audio.duration);
      }
    });

    progress.addEventListener('input', () => {
      if (audio.duration) {
        audio.currentTime = progress.value / 100 * audio.duration;
      }
    });

    function formatTime(sec) {
      sec = Math.floor(sec);
      let m = Math.floor(sec / 60);
      let s = sec % 60;
      return (m < 10 ? '0' : '') + m + ':' + (s < 10 ? '0' : '') + s;
    }
  </script>
</body>
</html>
